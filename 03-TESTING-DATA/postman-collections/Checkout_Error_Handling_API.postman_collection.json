{
	"info": {
		"_postman_id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
		"name": "Checkout Error Handling API - PSP Testing",
		"description": "Colección completa para pruebas de gestión de errores en Checkout con PSPs (Cybersource y PayPal)\n\nAutor: QA Analyst con ISTQB\nFecha: 2025-12-24\nObjetivo: Validar mensajes de error y códigos de respuesta según especificación",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Cybersource - Denegaciones",
			"item": [
				{
					"name": "DECLINED - EXPIRED_CARD",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"HTTP Status es 201\", function () {",
									"    pm.response.to.have.status(201);",
									"});",
									"",
									"pm.test(\"Status es DECLINED\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.status).to.eql(\"DECLINED\");",
									"});",
									"",
									"pm.test(\"Reason es EXPIRED_CARD\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.reason).to.eql(\"EXPIRED_CARD\");",
									"});",
									"",
									"pm.test(\"Mensaje al cliente es correcto\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.mensaje_cliente).to.eql(\"Pago no procesado. Revisa los datos de tu tarjeta\");",
									"});",
									"",
									"pm.test(\"No requiere alerta\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.alerta).to.be.undefined;",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"psp\": \"Cybersource\",\n  \"proceso\": \"Pago\",\n  \"card_number\": \"4111111111111111\",\n  \"expiry_date\": \"12/2020\",\n  \"cvv\": \"123\",\n  \"amount\": 100.00\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/payment/process",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"payment",
								"process"
							]
						},
						"description": "Prueba de tarjeta expirada.\n\nRespuesta esperada:\n- HTTP: 201\n- Status: DECLINED\n- Reason: EXPIRED_CARD\n- Mensaje: Pago no procesado. Revisa los datos de tu tarjeta"
					},
					"response": [
						{
							"name": "EXPIRED_CARD - Success Response",
							"originalRequest": {
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"psp\": \"Cybersource\",\n  \"proceso\": \"Pago\",\n  \"card_number\": \"4111111111111111\",\n  \"expiry_date\": \"12/2020\",\n  \"cvv\": \"123\",\n  \"amount\": 100.00\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{base_url}}/api/payment/process",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"api",
										"payment",
										"process"
									]
								}
							},
							"status": "Created",
							"code": 201,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n  \"psp\": \"Cybersource\",\n  \"categoria\": \"Denegación\",\n  \"http_code\": 201,\n  \"proceso\": \"Pago\",\n  \"status\": \"DECLINED\",\n  \"reason\": \"EXPIRED_CARD\",\n  \"mensaje_cliente\": \"Pago no procesado. Revisa los datos de tu tarjeta\"\n}"
						}
					]
				},
				{
					"name": "DECLINED - PROCESSOR_DECLINED",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"HTTP Status es 201\", function () {",
									"    pm.response.to.have.status(201);",
									"});",
									"",
									"pm.test(\"Status es DECLINED\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.status).to.eql(\"DECLINED\");",
									"});",
									"",
									"pm.test(\"Reason es PROCESSOR_DECLINED\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.reason).to.eql(\"PROCESSOR_DECLINED\");",
									"});",
									"",
									"pm.test(\"Mensaje al cliente es correcto\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.mensaje_cliente).to.eql(\"Pago no procesado. Por favor, inténtalo con otra tarjeta o medio de pago.\");",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"psp\": \"Cybersource\",\n  \"proceso\": \"Pago\",\n  \"card_number\": \"4111111111111112\",\n  \"expiry_date\": \"12/2026\",\n  \"cvv\": \"123\",\n  \"amount\": 100.00\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/payment/process",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"payment",
								"process"
							]
						},
						"description": "Prueba de rechazo por procesador.\n\nRespuesta esperada:\n- HTTP: 201\n- Status: DECLINED\n- Reason: PROCESSOR_DECLINED\n- Mensaje: Pago no procesado. Por favor, inténtalo con otra tarjeta o medio de pago."
					},
					"response": [
						{
							"name": "PROCESSOR_DECLINED - Success Response",
							"originalRequest": {
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"psp\": \"Cybersource\",\n  \"proceso\": \"Pago\",\n  \"card_number\": \"4111111111111112\",\n  \"expiry_date\": \"12/2026\",\n  \"cvv\": \"123\",\n  \"amount\": 100.00\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{base_url}}/api/payment/process",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"api",
										"payment",
										"process"
									]
								}
							},
							"status": "Created",
							"code": 201,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n  \"psp\": \"Cybersource\",\n  \"categoria\": \"Denegación\",\n  \"http_code\": 201,\n  \"proceso\": \"Pago\",\n  \"status\": \"DECLINED\",\n  \"reason\": \"PROCESSOR_DECLINED\",\n  \"mensaje_cliente\": \"Pago no procesado. Por favor, inténtalo con otra tarjeta o medio de pago.\"\n}"
						}
					]
				},
				{
					"name": "DECLINED - INSUFFICIENT_FUND",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"HTTP Status es 201\", function () {",
									"    pm.response.to.have.status(201);",
									"});",
									"",
									"pm.test(\"Status es DECLINED\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.status).to.eql(\"DECLINED\");",
									"});",
									"",
									"pm.test(\"Reason es INSUFFICIENT_FUND\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.reason).to.eql(\"INSUFFICIENT_FUND\");",
									"});",
									"",
									"pm.test(\"Mensaje al cliente es correcto\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.mensaje_cliente).to.eql(\"Pago no procesado. Por favor, inténtalo con otra tarjeta o medio de pago.\");",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"psp\": \"Cybersource\",\n  \"proceso\": \"Pago\",\n  \"card_number\": \"4111111111111113\",\n  \"expiry_date\": \"12/2026\",\n  \"cvv\": \"123\",\n  \"amount\": 100.00\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/payment/process",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"payment",
								"process"
							]
						},
						"description": "Prueba de fondos insuficientes.\n\nRespuesta esperada:\n- HTTP: 201\n- Status: DECLINED\n- Reason: INSUFFICIENT_FUND\n- Mensaje: Pago no procesado. Por favor, inténtalo con otra tarjeta o medio de pago."
					},
					"response": []
				},
				{
					"name": "DECLINED - CVN_NOT_MATCH",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"HTTP Status es 201\", function () {",
									"    pm.response.to.have.status(201);",
									"});",
									"",
									"pm.test(\"Status es DECLINED\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.status).to.eql(\"DECLINED\");",
									"});",
									"",
									"pm.test(\"Reason es CVN_NOT_MATCH\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.reason).to.eql(\"CVN_NOT_MATCH\");",
									"});",
									"",
									"pm.test(\"Mensaje al cliente es correcto\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.mensaje_cliente).to.eql(\"Pago no procesado. Revisa los datos de tu tarjeta\");",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"psp\": \"Cybersource\",\n  \"proceso\": \"Pago\",\n  \"card_number\": \"4111111111111111\",\n  \"expiry_date\": \"12/2026\",\n  \"cvv\": \"999\",\n  \"amount\": 100.00\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/payment/process",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"payment",
								"process"
							]
						},
						"description": "Prueba de CVV incorrecto.\n\nRespuesta esperada:\n- HTTP: 201\n- Status: DECLINED\n- Reason: CVN_NOT_MATCH\n- Mensaje: Pago no procesado. Revisa los datos de tu tarjeta"
					},
					"response": []
				},
				{
					"name": "AUTHORIZED_RISK_DECLINED - SCORE_EXCEEDS_THRESHOLD",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"HTTP Status es 201\", function () {",
									"    pm.response.to.have.status(201);",
									"});",
									"",
									"pm.test(\"Status es AUTHORIZED_RISK_DECLINED\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.status).to.eql(\"AUTHORIZED_RISK_DECLINED\");",
									"});",
									"",
									"pm.test(\"Reason es SCORE_EXCEEDS_THRESHOLD\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.reason).to.eql(\"SCORE_EXCEEDS_THRESHOLD\");",
									"});",
									"",
									"pm.test(\"Mensaje al cliente es correcto\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.mensaje_cliente).to.eql(\"No pudimos completar tu pago. Intenta con otro método o contacta a tu banco.\");",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"psp\": \"Cybersource\",\n  \"proceso\": \"Pago\",\n  \"card_number\": \"4111111111111115\",\n  \"expiry_date\": \"12/2026\",\n  \"cvv\": \"123\",\n  \"amount\": 10000.00,\n  \"fraud_score\": 95\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/payment/process",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"payment",
								"process"
							]
						},
						"description": "Prueba de rechazo por score de riesgo.\n\nRespuesta esperada:\n- HTTP: 201\n- Status: AUTHORIZED_RISK_DECLINED\n- Reason: SCORE_EXCEEDS_THRESHOLD\n- Mensaje: No pudimos completar tu pago. Intenta con otro método o contacta a tu banco."
					},
					"response": []
				}
			],
			"description": "Casos de prueba para denegaciones de Cybersource"
		},
		{
			"name": "Cybersource - Errores Técnicos",
			"item": [
				{
					"name": "INVALID_REQUEST - INVALID_MERCHANT_CONFIGURATION",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"HTTP Status es 201\", function () {",
									"    pm.response.to.have.status(201);",
									"});",
									"",
									"pm.test(\"Status es INVALID_REQUEST\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.status).to.eql(\"INVALID_REQUEST\");",
									"});",
									"",
									"pm.test(\"Reason es INVALID_MERCHANT_CONFIGURATION\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.reason).to.eql(\"INVALID_MERCHANT_CONFIGURATION\");",
									"});",
									"",
									"pm.test(\"Mensaje al cliente es correcto\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.mensaje_cliente).to.eql(\"Pago no procesado. Por favor, inténtalo con otro medio de pago\");",
									"});",
									"",
									"pm.test(\"Requiere alerta de criticidad Alta\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.alerta).to.eql(\"Alta\");",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"psp\": \"Cybersource\",\n  \"proceso\": \"Pago\",\n  \"merchant_id\": \"INVALID_MERCHANT\",\n  \"card_number\": \"4111111111111111\",\n  \"expiry_date\": \"12/2026\",\n  \"cvv\": \"123\",\n  \"amount\": 100.00\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/payment/process",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"payment",
								"process"
							]
						},
						"description": "Prueba de configuración de merchant inválida.\n\nRespuesta esperada:\n- HTTP: 201\n- Status: INVALID_REQUEST\n- Reason: INVALID_MERCHANT_CONFIGURATION\n- Mensaje: Pago no procesado. Por favor, inténtalo con otro medio de pago\n- Alerta: Alta"
					},
					"response": []
				},
				{
					"name": "INVALID_REQUEST - MISSING_FIELD (400)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"HTTP Status es 400\", function () {",
									"    pm.response.to.have.status(400);",
									"});",
									"",
									"pm.test(\"Status es INVALID_REQUEST\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.status).to.eql(\"INVALID_REQUEST\");",
									"});",
									"",
									"pm.test(\"Reason es MISSING_FIELD\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.reason).to.eql(\"MISSING_FIELD\");",
									"});",
									"",
									"pm.test(\"Mensaje al cliente es correcto\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.mensaje_cliente).to.eql(\"Pago no procesado. Por favor, inténtalo con otro medio de pago\");",
									"});",
									"",
									"pm.test(\"Requiere alerta de criticidad Alta\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.alerta).to.eql(\"Alta\");",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"psp\": \"Cybersource\",\n  \"proceso\": \"Pago\",\n  \"card_number\": \"4111111111111111\",\n  \"expiry_date\": \"12/2026\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/payment/process",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"payment",
								"process"
							]
						},
						"description": "Prueba de campo faltante (CVV y amount).\n\nRespuesta esperada:\n- HTTP: 400\n- Status: INVALID_REQUEST\n- Reason: MISSING_FIELD\n- Mensaje: Pago no procesado. Por favor, inténtalo con otro medio de pago\n- Alerta: Alta"
					},
					"response": []
				},
				{
					"name": "INVALID_REQUEST - DUPLICATE_REQUEST (400)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"HTTP Status es 400\", function () {",
									"    pm.response.to.have.status(400);",
									"});",
									"",
									"pm.test(\"Status es INVALID_REQUEST\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.status).to.eql(\"INVALID_REQUEST\");",
									"});",
									"",
									"pm.test(\"Reason es DUPLICATE_REQUEST\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.reason).to.eql(\"DUPLICATE_REQUEST\");",
									"});",
									"",
									"pm.test(\"Mensaje al cliente es correcto\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.mensaje_cliente).to.eql(\"Pago no procesado. Por favor, vuelve a intentarlo más tarde.\");",
									"});",
									"",
									"pm.test(\"Requiere alerta de criticidad Alta\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.alerta).to.eql(\"Alta\");",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "X-Request-ID",
								"value": "DUPLICATE-123456"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"psp\": \"Cybersource\",\n  \"proceso\": \"Pago\",\n  \"request_id\": \"DUPLICATE-123456\",\n  \"card_number\": \"4111111111111111\",\n  \"expiry_date\": \"12/2026\",\n  \"cvv\": \"123\",\n  \"amount\": 100.00\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/payment/process",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"payment",
								"process"
							]
						},
						"description": "Prueba de request duplicado.\n\nRespuesta esperada:\n- HTTP: 400\n- Status: INVALID_REQUEST\n- Reason: DUPLICATE_REQUEST\n- Mensaje: Pago no procesado. Por favor, vuelve a intentarlo más tarde.\n- Alerta: Alta"
					},
					"response": []
				},
				{
					"name": "SERVER_ERROR - SYSTEM_ERROR (502)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"HTTP Status es 502\", function () {",
									"    pm.response.to.have.status(502);",
									"});",
									"",
									"pm.test(\"Status es SERVER_ERROR\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.status).to.eql(\"SERVER_ERROR\");",
									"});",
									"",
									"pm.test(\"Reason es SYSTEM_ERROR\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.reason).to.eql(\"SYSTEM_ERROR\");",
									"});",
									"",
									"pm.test(\"Mensaje al cliente es correcto\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.mensaje_cliente).to.eql(\"Pago no procesado. Por favor, vuelve a intentarlo más tarde.\");",
									"});",
									"",
									"pm.test(\"Requiere alerta de criticidad Alta\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.alerta).to.eql(\"Alta\");",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "X-Simulate-Error",
								"value": "SYSTEM_ERROR"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"psp\": \"Cybersource\",\n  \"proceso\": \"Pago\",\n  \"card_number\": \"4111111111111111\",\n  \"expiry_date\": \"12/2026\",\n  \"cvv\": \"123\",\n  \"amount\": 100.00\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/payment/process",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"payment",
								"process"
							]
						},
						"description": "Prueba de error del sistema.\n\nRespuesta esperada:\n- HTTP: 502\n- Status: SERVER_ERROR\n- Reason: SYSTEM_ERROR\n- Mensaje: Pago no procesado. Por favor, vuelve a intentarlo más tarde.\n- Alerta: Alta"
					},
					"response": []
				}
			],
			"description": "Casos de prueba para errores técnicos de Cybersource"
		},
		{
			"name": "PayPal - Flujos Exitosos",
			"item": [
				{
					"name": "Agreement Created - 201",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"HTTP Status es 201\", function () {",
									"    pm.response.to.have.status(201);",
									"});",
									"",
									"pm.test(\"Status es Created\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.status).to.eql(\"Created\");",
									"});",
									"",
									"pm.test(\"Agreement ID está presente\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.agreement_id).to.exist;",
									"});",
									"",
									"pm.test(\"No requiere mensaje de error\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.mensaje_cliente).to.be.undefined;",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"psp\": \"PayPal\",\n  \"proceso\": \"Creación de Agreement\",\n  \"user_id\": \"user123\",\n  \"billing_plan_id\": \"plan456\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/payment/agreement",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"payment",
								"agreement"
							]
						},
						"description": "Prueba de creación exitosa de agreement.\n\nRespuesta esperada:\n- HTTP: 201\n- Status: Created\n- Mostrar el agreement creado"
					},
					"response": []
				},
				{
					"name": "Payment Success - 200",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"HTTP Status es 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Status es OK\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.status).to.eql(\"OK\");",
									"});",
									"",
									"pm.test(\"Payment ID está presente\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.payment_id).to.exist;",
									"});",
									"",
									"pm.test(\"Debe redirigir a página de confirmación\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.redirect_url).to.include(\"confirmation\");",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"psp\": \"PayPal\",\n  \"proceso\": \"Pago\",\n  \"paypal_token\": \"EC-12345ABCDE\",\n  \"payer_id\": \"PAYER123\",\n  \"amount\": 100.00\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/payment/process",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"payment",
								"process"
							]
						},
						"description": "Prueba de pago exitoso con PayPal.\n\nRespuesta esperada:\n- HTTP: 200\n- Status: OK\n- Redirigir a página de confirmación"
					},
					"response": []
				}
			],
			"description": "Casos de prueba exitosos para PayPal"
		},
		{
			"name": "PayPal - Errores Técnicos",
			"item": [
				{
					"name": "Bad Request - 400",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"HTTP Status es 400\", function () {",
									"    pm.response.to.have.status(400);",
									"});",
									"",
									"pm.test(\"Status es Bad Request\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.status).to.eql(\"Bad Request\");",
									"});",
									"",
									"pm.test(\"Mensaje al cliente es correcto\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.mensaje_cliente).to.eql(\"Ha ocurrido un error al procesar tu solicitud. Revisa los datos e inténtalo de nuevo.\");",
									"});",
									"",
									"pm.test(\"Requiere alerta de criticidad Alta\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.alerta).to.eql(\"Alta\");",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"psp\": \"PayPal\",\n  \"proceso\": \"Pago\",\n  \"invalid_field\": \"value\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/payment/process",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"payment",
								"process"
							]
						},
						"description": "Prueba de solicitud mal formada.\n\nRespuesta esperada:\n- HTTP: 400\n- Status: Bad Request\n- Mensaje: Ha ocurrido un error al procesar tu solicitud. Revisa los datos e inténtalo de nuevo.\n- Alerta: Alta"
					},
					"response": []
				},
				{
					"name": "Unauthorized - 401",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"HTTP Status es 401\", function () {",
									"    pm.response.to.have.status(401);",
									"});",
									"",
									"pm.test(\"Status es Unauthorized\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.status).to.eql(\"Unauthorized\");",
									"});",
									"",
									"pm.test(\"Mensaje al cliente es correcto\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.mensaje_cliente).to.eql(\"Pago no procesado. Por favor, inténtalo con otro medio de pago\");",
									"});",
									"",
									"pm.test(\"Requiere alerta de criticidad Alta\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.alerta).to.eql(\"Alta\");",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer INVALID_TOKEN"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"psp\": \"PayPal\",\n  \"proceso\": \"Pago\",\n  \"amount\": 100.00\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/payment/process",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"payment",
								"process"
							]
						},
						"description": "Prueba de autenticación inválida.\n\nRespuesta esperada:\n- HTTP: 401\n- Status: Unauthorized\n- Mensaje: Pago no procesado. Por favor, inténtalo con otro medio de pago\n- Alerta: Alta"
					},
					"response": []
				},
				{
					"name": "Unprocessable Entity - 422",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"HTTP Status es 422\", function () {",
									"    pm.response.to.have.status(422);",
									"});",
									"",
									"pm.test(\"Status es Unprocessable Entity\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.status).to.eql(\"Unprocessable Entity\");",
									"});",
									"",
									"pm.test(\"Mensaje al cliente es correcto\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.mensaje_cliente).to.eql(\"Pago no procesado. Por favor, inténtalo con otro medio de pago\");",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"psp\": \"PayPal\",\n  \"proceso\": \"Pago\",\n  \"amount\": -100.00\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/payment/process",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"payment",
								"process"
							]
						},
						"description": "Prueba de entidad no procesable (amount negativo).\n\nRespuesta esperada:\n- HTTP: 422\n- Status: Unprocessable Entity\n- Mensaje: Pago no procesado. Por favor, inténtalo con otro medio de pago"
					},
					"response": []
				},
				{
					"name": "Too Many Requests - 429",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"HTTP Status es 429\", function () {",
									"    pm.response.to.have.status(429);",
									"});",
									"",
									"pm.test(\"Status es Too Many Requests\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.status).to.eql(\"Too Many Requests\");",
									"});",
									"",
									"pm.test(\"Mensaje al cliente es correcto\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.mensaje_cliente).to.eql(\"Pago no procesado. Por favor, vuelve a intentarlo más tarde.\");",
									"});",
									"",
									"pm.test(\"Requiere alerta de criticidad Alta\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.alerta).to.eql(\"Alta\");",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "X-Simulate-Rate-Limit",
								"value": "true"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"psp\": \"PayPal\",\n  \"proceso\": \"Pago\",\n  \"amount\": 100.00\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/payment/process",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"payment",
								"process"
							]
						},
						"description": "Prueba de límite de rate excedido.\n\nRespuesta esperada:\n- HTTP: 429\n- Status: Too Many Requests\n- Mensaje: Pago no procesado. Por favor, vuelve a intentarlo más tarde.\n- Alerta: Alta"
					},
					"response": []
				},
				{
					"name": "Internal Server Error - 500",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"HTTP Status es 500\", function () {",
									"    pm.response.to.have.status(500);",
									"});",
									"",
									"pm.test(\"Status es Internal Server Error\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.status).to.eql(\"Internal Server Error\");",
									"});",
									"",
									"pm.test(\"Mensaje al cliente es correcto\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.mensaje_cliente).to.eql(\"Pago no procesado. Por favor, vuelve a intentarlo más tarde.\");",
									"});",
									"",
									"pm.test(\"Requiere alerta de criticidad Alta\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.alerta).to.eql(\"Alta\");",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "X-Simulate-Error",
								"value": "500"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"psp\": \"PayPal\",\n  \"proceso\": \"Pago\",\n  \"amount\": 100.00\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/payment/process",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"payment",
								"process"
							]
						},
						"description": "Prueba de error interno del servidor.\n\nRespuesta esperada:\n- HTTP: 500\n- Status: Internal Server Error\n- Mensaje: Pago no procesado. Por favor, vuelve a intentarlo más tarde.\n- Alerta: Alta"
					},
					"response": []
				},
				{
					"name": "Service Unavailable - 503",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"HTTP Status es 503\", function () {",
									"    pm.response.to.have.status(503);",
									"});",
									"",
									"pm.test(\"Status es Service Unavailable\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.status).to.eql(\"Service Unavailable\");",
									"});",
									"",
									"pm.test(\"Mensaje al cliente es correcto\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.mensaje_cliente).to.eql(\"Pago no procesado. Por favor, vuelve a intentarlo más tarde.\");",
									"});",
									"",
									"pm.test(\"Requiere alerta de criticidad Alta\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.alerta).to.eql(\"Alta\");",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "X-Simulate-Unavailable",
								"value": "true"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"psp\": \"PayPal\",\n  \"proceso\": \"Pago\",\n  \"amount\": 100.00\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/payment/process",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"payment",
								"process"
							]
						},
						"description": "Prueba de servicio no disponible.\n\nRespuesta esperada:\n- HTTP: 503\n- Status: Service Unavailable\n- Mensaje: Pago no procesado. Por favor, vuelve a intentarlo más tarde.\n- Alerta: Alta"
					},
					"response": []
				}
			],
			"description": "Casos de prueba de errores técnicos para PayPal"
		},
		{
			"name": "Edge Cases",
			"item": [
				{
					"name": "Error Code No Documentado - Mensaje Genérico",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Código de error no documentado\", function () {",
									"    pm.response.to.have.status(201);",
									"});",
									"",
									"pm.test(\"Mensaje genérico mostrado\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.mensaje_cliente).to.eql(\"Pago no procesado. Por favor, inténtalo con otra forma de pago\");",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"psp\": \"Cybersource\",\n  \"proceso\": \"Pago\",\n  \"simulate_unknown_error\": true,\n  \"card_number\": \"4111111111111111\",\n  \"expiry_date\": \"12/2026\",\n  \"cvv\": \"123\",\n  \"amount\": 100.00\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/payment/process",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"payment",
								"process"
							]
						},
						"description": "Prueba de código de error no documentado.\n\nRespuesta esperada:\n- Mensaje genérico: Pago no procesado. Por favor, inténtalo con otra forma de pago"
					},
					"response": []
				}
			],
			"description": "Casos extremos y edge cases"
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					"// Script de pre-request global",
					"console.log('Ejecutando request: ' + pm.info.requestName);",
					"console.log('Timestamp: ' + new Date().toISOString());"
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"exec": [
					"// Script de test global",
					"pm.test(\"Response time es menor a 2000ms\", function () {",
					"    pm.expect(pm.response.responseTime).to.be.below(2000);",
					"});",
					"",
					"pm.test(\"Content-Type es application/json\", function () {",
					"    pm.response.to.have.header(\"Content-Type\");",
					"    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\");",
					"});"
				]
			}
		}
	],
	"variable": [
		{
			"key": "base_url",
			"value": "https://api-checkout.example.com",
			"type": "string"
		},
		{
			"key": "environment",
			"value": "staging",
			"type": "string"
		}
	]
}
